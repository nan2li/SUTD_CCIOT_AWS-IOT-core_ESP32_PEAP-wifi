#include "WiFi.h"
#include "esp_wifi.h"
#include "esp_wpa2.h" 

const char* ssid = "SUTD_Wifi";
const char* username = "100xxx"; // PEAP username
const char* password = "xxxxxx"; // PEAP secret

void setup() {
  Serial.begin(115200);

  WiFi.disconnect(true); 
  delay(1000);

  // Cpnfigure ESP32 to STA
  WiFi.mode(WIFI_STA);

  // Active WPA2 Enterprise
  esp_wifi_sta_wpa2_ent_set_identity((uint8_t *)username, strlen(username));
  esp_wifi_sta_wpa2_ent_set_username((uint8_t *)username, strlen(username));
  esp_wifi_sta_wpa2_ent_set_password((uint8_t *)password, strlen(password));
  esp_wifi_sta_wpa2_ent_enable();

  WiFi.begin(ssid);

  Serial.print("Connecting to WiFi");
  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(".");
  }
  Serial.println();
  Serial.println("WiFi connected!");
  Serial.print("IP address: ");
  Serial.println(WiFi.localIP());
}

void loop() {
  // WiFi connected, do something
}
